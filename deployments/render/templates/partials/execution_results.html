<!-- å®Ÿè¡Œçµæœ - ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ã¨è©³ç´°æƒ…å ±ã‚’ã¾ã¨ã‚ã¦è¡¨ç¤º -->

<!-- ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ -->
<div class="leaderboard-wrapper" style="margin-bottom: 2rem;">
    <h3>ğŸ† ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰</h3>
    <table>
        <thead>
            <tr>
                <th>é †ä½</th>
                <th>ãƒ¢ãƒ‡ãƒ«</th>
                <th>ã‚¹ã‚³ã‚¢</th>
                <th>å®Ÿè¡Œæ™‚é–“</th>
                <th>èª¬æ˜</th>
                <th>è©³ç´°</th>
            </tr>
        </thead>
        <tbody>
            {% for result in results %}
            <tr>
                <td><strong>{{ loop.index }}</strong></td>
                <td>{{ result.model }}</td>
                <td>
                    <strong style="font-size: 1.2em; color: #0066cc;">
                        {{ result.score }}
                    </strong>/100
                </td>
                <td>{{ "%.2f"|format(result.duration) }}s</td>
                <td style="max-width: 300px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                    {{ result.explanation[:100] }}...
                </td>
                <td>
                    {% if result.execution_id %}
                    <button type="button"
                            class="execution-detail-btn"
                            data-execution-id="{{ result.execution_id }}"
                            onclick="loadExecutionDetail({{ result.execution_id }})"
                            style="padding: 0.5rem 1rem; background: #f0f0f0; border: 1px solid #ccc; border-radius: 4px; cursor: pointer;">
                        ğŸ‘ï¸ è©³ç´°
                    </button>
                    {% else %}
                    <span style="color: #999; font-size: 0.9em;">-</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- å®Ÿè¡Œè©³ç´°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
<div id="execution-detail-container" style="margin-top: 2rem; padding: 1.5rem; background: #f8f9fa; border-radius: 4px;">
    <p style="color: #999; text-align: center; margin: 0;">ğŸ‘† ä¸Šã®ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ã‹ã‚‰è©³ç´°ã‚’é¸æŠã—ã¦ãã ã•ã„</p>
</div>

<script>
/**
 * å®Ÿè¡Œè©³ç´°ã‚’èª­ã¿è¾¼ã‚“ã§è¡¨ç¤º
 */
function loadExecutionDetail(executionId) {
    const container = document.getElementById('execution-detail-container');
    if (!container) return;

    // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
    container.innerHTML = '<div style="text-align: center; padding: 2rem;"><div class="loading" style="margin: 1rem auto; width: 40px; height: 40px; border-width: 4px;"></div><p>è©³ç´°ã‚’èª­ã¿è¾¼ã¿ä¸­...</p></div>';

    // htmxã§è©³ç´°ã‚’å–å¾—
    htmx.ajax('GET', `/execution/${executionId}/detail`, container);
}
</script>
