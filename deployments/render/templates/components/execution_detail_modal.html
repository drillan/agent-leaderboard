<!-- „Ç®„Éº„Ç∏„Çß„É≥„ÉàÂÆüË°åË©≥Á¥∞„É¢„Éº„ÉÄ„É´ -->
<div class="modal-header">
    <h3>{{ execution.model_provider }}/{{ execution.model_name }}</h3>
    <button type="button" onclick="document.getElementById('modal').classList.add('hidden')" style="font-size: 1.5rem;">
        ‚úï
    </button>
</div>

<div class="modal-body">
    <!-- Ë©ï‰æ°ÁµêÊûú„Çª„ÇØ„Ç∑„Éß„É≥ -->
    <section>
        <h4>üìä Ë©ï‰æ°ÁµêÊûú</h4>
        <div class="score-display">
            <span class="score">{{ evaluation.score }}</span>/100
        </div>
        <p>{{ evaluation.explanation }}</p>
    </section>

    <!-- ÂÆüË°å„É≠„Ç∞„Çª„ÇØ„Ç∑„Éß„É≥ -->
    <section>
        <h4>üìù ÂÆüË°å„É≠„Ç∞</h4>
        <div class="execution-log">
            {% if messages %}
                {% for message in messages %}
                    <div class="log-entry log-{{ message.role }}">
                        <div class="log-header">
                            <strong>{{ message.role | title }}</strong>
                            <span class="timestamp">{{ message.timestamp }}</span>
                        </div>
                        <div class="log-content">
                            {{ message.content }}
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p class="placeholder">„É≠„Ç∞„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>
            {% endif %}
        </div>
    </section>

    <!-- „É°„Éà„É™„ÇØ„Çπ„Çª„ÇØ„Ç∑„Éß„É≥ -->
    <section>
        <h4>‚ö° „Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„É°„Éà„É™„ÇØ„Çπ</h4>
        <table style="width: 100%;">
            <tr>
                <td style="width: 50%; padding: 0.5rem;"><strong>ÂÆüË°åÊôÇÈñì:</strong></td>
                <td style="padding: 0.5rem;">{{ "%.2f" | format(execution.duration_seconds or 0) }} Áßí</td>
            </tr>
            <tr>
                <td style="width: 50%; padding: 0.5rem;"><strong>„Éà„Éº„ÇØ„É≥Êï∞:</strong></td>
                <td style="padding: 0.5rem;">{{ execution.token_count or "N/A" }}</td>
            </tr>
            <tr>
                <td style="width: 50%; padding: 0.5rem;"><strong>„Çπ„ÉÜ„Éº„Çø„Çπ:</strong></td>
                <td style="padding: 0.5rem;">
                    <span style="display: inline-block; padding: 0.25rem 0.75rem; background: #f0f0f0; border-radius: 4px; font-size: 0.85rem;">
                        {{ execution.status }}
                    </span>
                </td>
            </tr>
        </table>
    </section>

    <!-- „ÉÑ„Éº„É´Âëº„Å≥Âá∫„Åó„Çª„ÇØ„Ç∑„Éß„É≥Ôºà„Ç™„Éó„Ç∑„Éß„É≥Ôºâ -->
    {% if tool_calls %}
    <section>
        <h4>üîß „ÉÑ„Éº„É´Âëº„Å≥Âá∫„Åó</h4>
        <div class="tool-tree">
            {% for call in tool_calls %}
            <div style="padding: 0.5rem; background: white; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 0.5rem;">
                <details>
                    <summary>
                        <strong>{{ call.tool_name }}</strong>
                        <span class="call-id">#{{ call.call_id }}</span>
                    </summary>
                    <div class="tool-details">
                        {% if call.args %}
                        <div class="tool-args">
                            <strong>ÂºïÊï∞:</strong>
                            <pre>{{ call.args }}</pre>
                        </div>
                        {% endif %}
                        {% if call.result %}
                        <div class="tool-result">
                            <strong>ÁµêÊûú:</strong>
                            <pre>{{ call.result }}</pre>
                        </div>
                        {% endif %}
                    </div>
                </details>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}
</div>
